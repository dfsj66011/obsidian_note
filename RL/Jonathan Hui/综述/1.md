[

Write



](https://medium.com/new-story?source=post_page---top_nav_layout_nav-----------------------------------------)

[

](https://medium.com/me/notifications?source=post_page---top_nav_layout_nav-----------------------------------------)

![Dfsj](https://miro.medium.com/v2/resize:fill:64:64/0*PLjgQ4YC02_2Jtni)

Get unlimited access to the best of Medium for less than $1/week.

[

Become a member

](https://medium.com/plans?source=upgrade_membership---post_top_nav_upsell-----------------------------------------)

# RL— Introduction to Deep Reinforcement Learning

[

![Jonathan Hui](https://miro.medium.com/v2/resize:fill:64:64/1*c3Z3aOPBooxEX4tx4RkzLw.jpeg)





](https://jonathan-hui.medium.com/?source=post_page---byline--35c25e04c199---------------------------------------)

[Jonathan Hui](https://jonathan-hui.medium.com/?source=post_page---byline--35c25e04c199---------------------------------------)

Follow

20 min read

·

Oct 15, 2018

2.7K

11

[

](https://medium.com/plans?dimension=post_audio_button&postId=35c25e04c199&source=upgrade_membership---post_audio_button-----------------------------------------)

![](https://miro.medium.com/v2/resize:fit:700/0*JjsLueA2KATdLD5Z)

Photo by [Fab Lentz](https://unsplash.com/@fossy?utm_source=medium&utm_medium=referral)

Deep reinforcement learning is about taking the best actions from what we see and hear. Unfortunately, reinforcement learning **RL** has a high barrier in learning the concepts and the lingos. In this article, we will cover deep RL with an overview of the general landscape. Yet, we will not shy away from equations and lingos. They provide the basics in understanding the concepts deeper. We will not appeal to you that it only takes 20 lines of code to tackle an RL problem. The official answer should be one! But we will try hard to make it approachable.

In most AI topics, we create mathematical frameworks to tackle problems. For RL, the answer is the **Markov Decision Process (MDP)**. It sounds complicated but it produces an easy framework to model a complex problem. An **agent** (e.g. a human) observes the environment and takes **actions**. **Rewards** are given out but they may be infrequent and delayed. Very often, the long-delayed rewards make it extremely hard to untangle the information and traceback what sequence of actions contributed to the rewards.

Markov decision process (MDP) composes of:

![](https://miro.medium.com/v2/resize:fit:700/1*sMZBhROM7Wt4lqHUc6VRqw.jpeg)

![](https://miro.medium.com/v2/resize:fit:700/1*X6h1TXf4QidZbu2NfVl1wg.png)

Source: [left,](https://drive.google.com/file/d/0BxXI_RttTZAhVXBlMUVkQ1BVVDQ/view) [right](https://mitpress.mit.edu/books/reinforcement-learning)

**State** in MDP can be represented as raw images.

![](https://miro.medium.com/v2/resize:fit:700/1*aosA682yS21d8lhhgL9AHA.jpeg)

AlphaGO & Atari Seaquest

Or for robotic controls, we use sensors to measure the joint angles, velocity, and the end-effector pose:

![](https://miro.medium.com/v2/resize:fit:700/1*8snUNu8FgaAs6UMm-o69og.jpeg)

- An **action** can be a move in a chess game or moving a robotic arm or a joystick.
- For a GO game, the reward is very sparse: 1 if we win or -1 if we lose. Sometimes, we get rewards more frequently. In the Atari Seaquest game, we score whenever we hit the sharks.
- The discount factor discounts future rewards if it is smaller than one. Money earned in the future often has a smaller current value, and we may need it for a purely technical reason to converge the solution better.

![](https://miro.medium.com/v2/resize:fit:700/1*qR9uqk2c8LNB8LGQ6sU-qg.png)

- We can rollout actions forever or limit the experience to _N_ time steps. This is called the horizon.

The transition function is the system dynamics. It predicts the next state after taking action. It is called the **model** which plays a major role when we discuss Model-based RL later.

**Convention**

The concepts in RL come from many research fields including the control theory. Different notations are used in different contexts. Unfortunately, this is quite unavoidable when reading RL materials. So, let’s get this out first before any confusion. The state can be written as _s_ or _x_, and action as _a_ or _u_. **Action** is the same as **control**. We can maximize the rewards or minimizes the costs which are simply negative of each other. Notations can be in upper or lower case.

![](https://miro.medium.com/v2/resize:fit:700/1*SJXL97vgexqJkH6PT-VQQw.png)

# **Policy**

In RL, our focus is finding an optimal **policy.** A policy tells us how to act from a particular state.

![](https://miro.medium.com/v2/resize:fit:700/1*3qVw9kj0Unbh2SjScCt8wg.png)

Like the weights in Deep Learning methods, this policy can be parameterized by _θ,_

![](https://miro.medium.com/v2/resize:fit:700/1*XmXQfyvadrUd73ZOU1o95g.jpeg)

and we want to find a policy that makes the most rewarding decisions:

![](https://miro.medium.com/v2/resize:fit:700/1*7Yt8b1k0POIGR_cnqRvqPw.jpeg)

In real life, nothing is absolute. So our policy can be deterministic or stochastic. For stochastic, the policy outputs a probability distribution instead.

![](https://miro.medium.com/v2/resize:fit:700/1*fPfloA0G8zrz89OqpD2oJA.png)

![](https://miro.medium.com/v2/resize:fit:700/1*37PNsTcH0U5fe1UaCx810A.png)

Finally, let’s put our objective together. In RL, we want to find a ==sequence of actions that maximize expected rewards or minimize cost.==

![](https://miro.medium.com/v2/resize:fit:700/1*P4alpFJHhNtbbbXGK1UAUQ.jpeg)

But there are many ways to solve the problem. For example, we can

- ==Analyze how good to reach a certain state or take a specific action (i.e. Value-learning),==
- Use the model to find actions that have the maximum rewards (model-based learning), or
- Derive a policy directly to maximize rewards (policy gradient).

We will go through all these approaches shortly.

# Notation

But, in case you want further elaboration for the terms and notation in RL first, this table should help.

![](https://miro.medium.com/v2/resize:fit:700/1*uC5gslmql53IxSRSS1oBsg.jpeg)

Modified from [source](https://arxiv.org/pdf/1504.00702.pdf)

# **Model-based RL**

Intuitively, if we know the rule of the game and how much it costs for every move, we can find the actions that minimize the cost. The **model** **_p_** (the system dynamics) predicts the next state after taking an action. Mathematically, it is formulated as a probability distribution. In this article, the model can be written as **_p_** or **_f_**.

![](https://miro.medium.com/v2/resize:fit:700/1*J2s5B7bu63hBAmhC-CbWlw.jpeg)

Let’s demonstrate the idea of a model with a cart-pole example. **_p_** models the angle of the pole after taking action.

![](https://miro.medium.com/v2/resize:fit:700/1*Z9g2-AyfQbFHZMFDfwbnaQ.png)

![](https://miro.medium.com/v2/resize:fit:700/1*wJ3vb0rN0ZmnkZuOQpUtaA.jpeg)

Here is the probability distribution output for _θ_ in the next time step for the example above.

![](https://miro.medium.com/v2/resize:fit:700/1*32zFcyhR5eqDClXDbSplJQ.png)

This model describes the law of Physics. But a model can be just the rule of a chess game. ==The core idea of== ==**Model-based RL**== ==is== ==using the model and the cost function to locate the optimal path of actions (to be exact — a trajectory of states and actions).==

![](https://miro.medium.com/v2/resize:fit:700/1*uUKlBZW8EMS4L8jlVMDaWQ.jpeg)

![](https://miro.medium.com/v2/1*oWcm1sR3mZw_iSmiQDUr-Q.jpeg)

Let’s get into another example. In the GO game, the model is the rule of the game. According to this rule, we search the possible moves and find the actions to win the game. Of course, the search space is too large and we need to search smarter.

![](https://miro.medium.com/v2/1*U_9cl3HV5o_8DUC7gmsDXg.jpeg)

AlphaGO

> In model-based RL, we use the model and cost function to find **an optimal trajectory** of states and actions (**optimal control**).

Sometimes, we may not know the models. But this does not exclude us from learning them. Indeed, we can use deep learning to model complex motions from sample trajectories or approximate them locally.

The video below is a nice demonstration of performing tasks by a robot using Model-based RL. Instead of programming the robot arm directly, the robot is trained for 20 minutes to learn each task, mostly by itself. Once it is done, the robot should handle situations that have not trained before. We can move around the objects or change the grasp of the hammer, the robot should manage to complete the task successfully.

The tasks sound pretty simple. But they are not easy to solve. We often make approximations to make it easier. For example, we approximate the system dynamics to be linear and the cost function to be a quadratic equation.

![](https://miro.medium.com/v2/resize:fit:700/1*bRIOfdX3kSdX1FtPD8ChsA.jpeg)

![](https://miro.medium.com/v2/resize:fit:700/1*tq4EeBxSl4XmqAQnsw2d8g.jpeg)

Then we find the actions that minimize the cost while obeying the model.

![](https://miro.medium.com/v2/resize:fit:700/1*fJXD75kQup0hYRYBQUy17g.jpeg)

There are known optimization methods like LQR to solve this kind of objective. To move to non-linear system dynamics, we can apply iLQR which use LQR iteratively to find the optimal solution similar to Newton’s optimization. All these methods are complex and computationally intense. You can find the details in [here](https://medium.com/@jonathan_hui/rl-lqr-ilqr-linear-quadratic-regulator-a5de5104c750). But for our context, we just need to know that given a cost function and a model, we can find the corresponding optimal actions.

Model-based RL has a strong competitive edge over other RL methods because it is sample efficiency. ==Many models can be approximated locally with fewer samples and trajectory planning requires no further samples==. If physical simulation takes time, the saving is significant. Therefore, it is popular in robotic control. With other RL methods, the same training may take weeks.

Let’s detail the process a little bit more. The following is the MPC (Model Predictive Control) which runs a random or an educated policy to explore space to fit the model. Then, in step 3, we use iLQR to plan the optimal controls. But we only execute the first action in the plan. We observe the state again and replan the trajectory. This allows us to take corrective actions if needed.

![](https://miro.medium.com/v2/resize:fit:700/1*RSCF3Zd9Qykxg6V1w5ZRAQ.png)

[Source](http://rail.eecs.berkeley.edu/deeprlcourse-fa17/f17docs/lecture_9_model_based_rl.pdf)

The following figure summarizes the flow. We observe the environments and extract the states. We fit the model and use a trajectory optimization method to plan our path which composes of actions required at each time step.

![](https://miro.medium.com/v2/resize:fit:700/1*sQG2HXMcoU0_1TZcHAdNaA.jpeg)

# Value learning

Next, we go to another major RL method called Value Learning. In playing a GO game, it is very hard to plan the next winning move even the rule of the game is well understood. The exponential growth of possibilities makes it too hard to be solved. When the GO champions play the GO game, they evaluate how good a move is and how good to reach a certain board position. Assume we have a cheat sheet scoring every state:

![](https://miro.medium.com/v2/resize:fit:700/1*9MCyxA48Ibc2eLv4VkN0HQ.png)

We can simply look at the cheat sheet and find what is the next most rewarding state and take the corresponding action.

==**Value function**== ==_V(s)_== ==measures the expected discounted rewards for a state under a policy==. Intuitively, it measures the total rewards that you get from a particular state following a specific policy.

![](https://miro.medium.com/v2/resize:fit:700/1*mEkv4hfGxRwv6kHGkMgQ5A.png)

In our cart-pole example, we can use the pole stay-up time to measure the rewards. Below, there is a better chance to maintain the pole upright for the state _s1_ than _s2_ (better to be in the position on the left below than the right). For most policies, the state on the left is likely to have a higher value function.

![](https://miro.medium.com/v2/resize:fit:700/1*QsLkYHRrppgaqNiuI5GB-g.png)

So how to find out **_V_**? One method is the ==**Monte Carlo**== ==method==. We run the policy and play out the whole episode until the end to observe the total rewards. For example, we time how long the pole stays up. Then we have multiple Monte Carlo rollouts and we average the results for **_V_**.

There are a few ways to find the corresponding optimal policy. In ==**policy evaluation**==, we can start with a random policy and evaluate how good each state is. After many iterations, we use _V(s)_ to decide the next best state. Then, we use the model to determine the action that leads us there. For the GO game, this is simple since the rule of the game is known.

![](https://miro.medium.com/v2/resize:fit:700/1*RIBB9aho7mZZJYw31oVCTQ.jpeg)

Alternatively, after each policy evaluation, we improve the policy based on the value function. We continue the evaluation and refinement. Eventually, we will reach the optimal policy. This is called **policy iteration**.

![](https://miro.medium.com/v2/1*hdJrrav0zRMjzLsiMRFAjA.jpeg)

Modified from [source](https://mitpress.mit.edu/books/reinforcement-learning-second-edition)

But there is a problem if we do not have the model. We do not know what action can take us to the target state.

![](https://miro.medium.com/v2/resize:fit:700/1*RseWZkNGpAdPsoaKzNxeFQ.png)

Value function is not a model-free method. We need a model to make decisions. But as an important footnote, even when the model is unknown, value function is still helpful in complementing other RL methods that do not need a model.

**Value iteration with Dynamic programming**

Other than the Monte Carlo method, we can use dynamic programming to compute **_V_**. We take an action, observe the reward and compute it with the _V_-value of the next state:

![](https://miro.medium.com/v2/resize:fit:700/1*YjQoGPeaKHvLctl3WgCHqg.png)

The exact formula should be:

![](https://miro.medium.com/v2/resize:fit:700/1*_P5kRg0K5nx0NHw5OzKRkg.png)

If the model is unknown, we compute _V_ by sampling. We execute the action and observe the reward and the next state instead.

# Function fitting

However, maintain _V_ for every state is not feasible for many problems. To solve that, we use supervised learning to train a deep network that approximates _V_.

![](https://miro.medium.com/v2/1*e5F37FBP-x-65z61jtJiXg.jpeg)

**_y_** above is the target value and we can use the Monte Carlo method to compute it.

![](https://miro.medium.com/v2/resize:fit:700/1*2CHTa8r4m5kFQ-Cpbz0O0A.png)

Otherwise, we can apply the dynamic programming concept and use a one-step lookahead. This is called **Temporal Difference** TD.

![](https://miro.medium.com/v2/resize:fit:700/1*YjQoGPeaKHvLctl3WgCHqg.png)

We take a single action and use the observed reward and the _V_ value for the next state to compute _V(s)_.

![](https://miro.medium.com/v2/resize:fit:700/1*PYlL_2_2VGE2bl4I8SloQg.png)

The Monte Carlo method is accurate. But for a stochastic policy or a stochastic model, every run may have different results. So the variance is high. TD considers far fewer actions to update its value. So the variance is low. But at least in early training, the bias is very high. High bias gives wrong results but high variance makes the model very hard to converge. In practice, we can combine the Monte Carlo and TD with different _k_-step lookahead to form the target. This balances the bias and the variance which can stabilize the training.

# **Action-value function**

So can we use the value learning concept without a model? Yes, we can avoid the model by scoring an action instead of a state. Action-value function _Q(s, a)_ measures the expected discounted rewards of taking an action. The tradeoff is we have more data to track. For each state, if we can take _k_ actions, there will be _k Q_-values.

![](https://miro.medium.com/v2/resize:fit:700/1*k5JZbCNNJC4RFdtpj_wgFg.png)

For optimal results, we take the action with the highest _Q_-value.

![](https://miro.medium.com/v2/resize:fit:700/1*iRUppfcGcHpa9W_pcD2uAw.png)

As shown, we do not need a model to find the optimal action. Hence, Action-value learning is model-free. Which acton below has a higher Q-value? Intuitively, moving left at the state below should have a higher value than moving right.

![](https://miro.medium.com/v2/resize:fit:700/1*TuPcSwlIIelgv--DB6DKGg.png)

In deep learning, gradient descent works better when features are zero-centered. Intuitively, in RL, the absolute rewards may not be as important as how well an action does compare with the average action. That is the concept of the **advantage function** **_A_**. In many RL methods, we use _A_ instead of _Q_.

![](https://miro.medium.com/v2/resize:fit:700/1*PLMQ5z0EwH4R0RJiIn7snw.png)

where **_A_** is the expected rewards over the average actions. To recap, here are all the definitions:

![](https://miro.medium.com/v2/resize:fit:700/1*mEkv4hfGxRwv6kHGkMgQ5A.png)

![](https://miro.medium.com/v2/resize:fit:700/1*DB47b4EY0cVXZhWZ-D6gRg.png)

![](https://miro.medium.com/v2/resize:fit:700/1*xLyVqfy4yrPn9jPJcYrPbA.png)

# Q-learning

So how can we learn the Q-value? One of the most popular methods is Q-learning with the following steps:

1. We sample an action.
2. We observed the reward and the next state.
3. We take the action with the highest Q.

![](https://miro.medium.com/v2/resize:fit:700/1*NUFoDSKWxRQm7uqhiq6Xcg.jpeg)

Then we apply the dynamic programming again to compute the _Q_-value function iteratively:

![](https://miro.medium.com/v2/resize:fit:700/1*bJmVfEJ98XitkjW1z3TN7w.png)

Here is the algorithm of _Q_-learning with function fitting. Step 2 below reduces the variance by using Temporal Difference. This also improves the **sample efficiency** comparing with the Monte Carlo method which takes samples until the end of the episode.

![](https://miro.medium.com/v2/resize:fit:700/1*-MarQ95RdLWkj8p1upYCDA.jpeg)

Modified from [source](http://rail.eecs.berkeley.edu/deeprlcourse-fa17/index.html)

Exploration is very important in RL. Without exploration, you will never know what is better ahead. But if it is overdone, we are wasting time. In _Q_-learning, we have an exploration policy, like epsilon-greedy, to select the action taken in step 1. We pick the action with the highest _Q_ value but yet we allow a small chance of selecting other random actions. _Q_ is initialized with zero. Hence, there is no specific action standing out in early training. As the training progress, more promising actions are selected and the training shift from exploration to exploitation.

# Deep Q-network DQN

_Q_-learning is unfortunately not very stable with deep learning. In this section, we will finally put all things together and introduce the DQN which beats the human in playing some of the Atari Games by accessing the image frames only.

![](https://miro.medium.com/v2/resize:fit:700/1*l9dL-vOijkkHclYR1tOftA.png)

[Source](https://www.cs.toronto.edu/~vmnih/docs/dqn.pdf)

DQN is the poster child for _Q_-learning using a deep network to approximate _Q._ We use supervised learning to fit the _Q_-value function. We want to duplicate the success of supervised learning but RL is different. In deep learning, we randomize the input samples so the input class is quite balanced and pretty stable across training batches. In RL, we search better as we explore more. So the input space and actions we searched are constantly changing. In addition, as we know better, we update the target value of _Q_. That is bad news. Both the input and output are under frequent changes.

![](https://miro.medium.com/v2/resize:fit:700/1*1sAPBjetPifL0F9b9ahSsQ.jpeg)

This makes it very hard to learn the _Q-_value approximator. DQN introduces experience replay and target network to slow down the changes so we can learn _Q_ gradually. Experience replay stores the last million of state-action-reward in a replay buffer. We train _Q_ with batches of random samples from this buffer. Therefore, the training samples are randomized and behave closer to the supervised learning in Deep Learning.

In addition, we have two networks for storing the values of **_Q_**. One is constantly updated while the second one, the target network, is synchronized from the first network once a while. We use the target network to retrieve the **_Q_** value such that the changes for the target value are less volatile. Here is the objective for those interested. _D_ is the replay buffer and _θ-_ is the target network.

![](https://miro.medium.com/v2/resize:fit:700/1*3PNz2dU6Un5UW_YSmuvWvQ.jpeg)

DQN allows us to use value learning to solve RL methods in a more stable training environment.

# **_Policy-Gradient_**

So far we have covered two major RL methods: model-based and value learning. Model-based RL uses the model and the cost function to find the optimal path. Value learning uses _V_ or _Q_ value to derive the optimal policy. Next, we will cover the third major RL method, also one of the popular ones in RL. The Policy Gradient method focuses on the policy.

![](https://miro.medium.com/v2/resize:fit:700/1*eNkhTPvTUaiN6-QDklGJfw.jpeg)

Many of our actions, in particular with human motor controls, are very intuitive. We observe and act rather than plan it thoroughly or take samples for maximum returns.

![](https://miro.medium.com/v2/resize:fit:700/1*Dof34Ien0I0FOc-sOjcv3A.jpeg)

In the cart-pole example, we may not know the physics but when the pole falls to the left, our experience tells us to move left. Determining actions based on observations can be much easier than understanding a model.

![](https://miro.medium.com/v2/resize:fit:700/1*5gL04Bfqf4iXBCK1fLB8tg.png)

This type of RL method is **policy-based** which we model a policy parameterized by _θ_ directly.

The concept for Policy Gradient is very simple. For actions with better rewards, we make it more likely to happen (or vice versa). The policy gradient is computed as:

![](https://miro.medium.com/v2/resize:fit:700/1*knNdtuW11Rv_U2Gfy7G9Ww.png)

We use this gradient to update the policy using gradient ascent. i.e. we change the policy in the direction with the steepest reward increase.

![](https://miro.medium.com/v2/resize:fit:700/1*bTd1OpnOSpFK6V6IFk-kJA.png)

Let’s look at the policy gradient closely. The one underlines in red above is the maximum likelihood. It measures the likelihood of an action under a specific policy. As we multiply it with the advantage function, we change the policy to favor actions with rewards greater than the average action. Or vice versa, we reduce the chance if it is not better off.

But we need to be very careful in making such policy change. The gradient method is a first-order derivative method. It is not too accurate if the reward function has steep curvature. If our policy change is too aggressive, the estimated policy improvement may be too far off that the decision can be a disaster.

![](https://miro.medium.com/v2/resize:fit:700/1*a13NrOnCClT6uLmGYiYSKw.jpeg)

Image [source](https://pronetowanderfriends.wordpress.com/2014/02/23/angels-landing-in-zion-national-park-check/)

To address this issue, we impose a trust region. We pick the optimal control within this region only. By establishing an upper bound of the potential error, we know how far we can go before we get too optimistic and the potential error can kill us. Within the trust region, we have a reasonable guarantee that the new policy will be better off. Outside the trust region, the bet is off. If we force it, we may land in states that are much worse and destroy the training progress. TRPO and PPO are methods using the trust region concept to improve the convergence of the policy model.

# Actor-critic method

Policy Gradient methods use a lot of samples to reach an optimal solution. Every time the policy is updated, we need to resample. Similar to other deep learning methods, it takes many iterations to compute the model. Its convergence is often a major concern. Can we use fewer samples to compute the policy gradient? Can we further reduce the variance of _A_ to make the gradient less volatile?

![](https://miro.medium.com/v2/resize:fit:700/1*al_zhSPHusgnd_IT8UY6Pg.png)

RL methods are rarely mutually exclusive. We mix different approaches to complement each other. Actor-critic combines the policy gradient with function fitting. In the Actor-critic method, we use the **actor** to model the policy and the **critic** to model _V_. By introduce a critic, we reduce the number of samples to collect for each policy update. We don’t collect all samples until the end of an episode. This Temporal Difference technique also reduces variance.

The algorithm of actor-critic is very similar to the policy gradient method. In step 2 below, we are fitting the _V_-value function, that is the critic. In step 3, we use TD to calculate **_A_**. In step 5, we are updating our policy, the actor.

![](https://miro.medium.com/v2/resize:fit:700/1*JXFq4joINPlTANeLjymgGg.png)

[Source](http://rail.eecs.berkeley.edu/deeprlcourse/)

# Guide Policy Search

The actor-critic mixes the value-learning with policy gradient. Again, we can mix Model-based and Policy-based methods together. We use model-based RL to improve a controller and run the controller on a robot to make moves. A controller determines the best action based on the results of the trajectory optimization.

We observe the trajectories and in parallel, we use the generated trajectories to train a policy (the right figure below) using supervised learning.

![](https://miro.medium.com/v2/resize:fit:700/1*pypliLWLL9KOi0uSi9bDSw.jpeg)

Modified from [source](http://rail.eecs.berkeley.edu/deeprlcourse-fa17/f17docs/lecture_10_imitating_optimal_control.pdf)

Why we train a policy when we have a controller? Do they serve the same purpose in predicting the action from a state anyway? That comes to the question of whether the model or the policy is simpler.

Model-based learning can produce pretty accurate trajectories but may generate inconsistent results for areas where the model is complex and not well trained. Its accumulated errors can hurt also. If the policy is simpler, it should be easier to learn and to generalize. We can use supervised learning to eliminate the noise in the model-based trajectories and discover the fundamental rules behind them.

![](https://miro.medium.com/v2/resize:fit:700/1*op6zYpZATTaaB2VaxtrwrA.jpeg)

However, policy-gradient is similar to a trial-and-error method with smarter and educated searches. The training usually has a long warm-up period before seeing any actions that make sense.

![](https://miro.medium.com/v2/resize:fit:700/1*dd9kDFfsbUePj8JzcyaAew.png)

[Source](http://rail.eecs.berkeley.edu/deeprlcourse-fa17/f17docs/lecture_4_policy_gradient.pdf)

So we combine both of their strength in the Guided Policy Search. We use model-based RL to guide the search better. Then we use the trajectories to train a policy that can generalize better (if the policy is simpler for the task).

We train both controller and policy in an alternate step. To avoid aggressive changes, we apply the trust region between the controller and the policy again. So the policy and controller are learned in close steps. This helps the training to converge better.

![](https://miro.medium.com/v2/resize:fit:700/1*KN1b1nCagEJl7Ew3_ciKag.jpeg)

[Source](http://rail.eecs.berkeley.edu/deeprlcourse/)

# Deep Learning

What is the role of Deep Learning in reinforcement learning? As mentioned before, deep learning is the eye and the ear. We apply CNN to extract features from images and RNN for voices.

![](https://miro.medium.com/v2/resize:fit:700/1*01ts7lX7lCigVEdUJhqQ7A.jpeg)

A deep network is also a great function approximator. We can use it to approximate any functions we needed in RL. This includes _V_-value, _Q_-value, policy, and model.

![](https://miro.medium.com/v2/resize:fit:700/1*cV6MFkLt1M9dv9DZ-TFNJQ.jpeg)

**Partially Observable MDP**

For many problems, objects can be temporarily obstructed by others. To construct the state of the environment, we need more than the current image. For a Partially Observable MDP, we construct states from the recent history of images. This can be done by applying RNN to a sequence of images.

![](https://miro.medium.com/v2/resize:fit:700/1*hAExkREX6IGXQ1X1oOp34A.jpeg)

# Which methods to use?

We have introduced three major groups of RL methods. We can mix and match methods to complement each other and there are many improvements made to each method. Which methods are the best?

This will be impossible to explain within a single section. Each method has its strength and weakness. Model-based RL has the best sample efficiency so far but Model-free RL may have better optimal solutions under the current state of the technology. Sometimes, we can view it more like fashion. What is the best will depend on the year you ask? Research makes progress and out-of-favor methods may have a new lifeline after some improvements. In reality, we mix and match for RL problems. The desired method is strongly restricted by constraints, the context of the task, and the progress of the research. For example, robotic controls strongly favor methods with high sample efficiency. Physical simulations cannot be replaced by computer simulations easily. But yet in some problem domains, we can now bridge the gap or introduce self-learning better. In short, we are still in a highly evolving field and therefore there is no golden guideline yet. We can only say at the current state, what method may be better under the constraints and the context of your task. Stay tuned and we will have more detailed discussions on this.

# Thoughts

Deep reinforcement learning is about how we make decisions. In this article, we cover three basic algorithm groups namely, model-based RL, value learning, and policy gradients. This is just a start. How to learn as efficiently as a human remains challenging. The bad news is there is a lot of room to improve for commercial applications. The good news is the problem is so hard but important that don’t expect that the subject is boring. In this article, we explore the basic but hardly touch on its challenge and many innovative solutions that have been proposed. It is one of the hardest areas in AI but probably one of the hardest parts of daily life also. For those who want to explore more, here are the articles detailing different RL areas.

[

## Deep Reinforcement Learning Series

### Deep Reinforcement Learning is about making the best decisions for what we see and what we hear. It sounds simple but…

medium.com



](https://medium.com/@jonathan_hui/rl-deep-reinforcement-learning-series-833319a95530?source=post_page-----35c25e04c199---------------------------------------)

[

Machine Learning

](https://medium.com/tag/machine-learning?source=post_page-----35c25e04c199---------------------------------------)

[

Artificial Intelligence

](https://medium.com/tag/artificial-intelligence?source=post_page-----35c25e04c199---------------------------------------)

[

Data Science

](https://medium.com/tag/data-science?source=post_page-----35c25e04c199---------------------------------------)

[

Programming

](https://medium.com/tag/programming?source=post_page-----35c25e04c199---------------------------------------)

[

Deep Learning

](https://medium.com/tag/deep-learning?source=post_page-----35c25e04c199---------------------------------------)

2.7K

11

[

![Jonathan Hui](https://miro.medium.com/v2/resize:fill:96:96/1*c3Z3aOPBooxEX4tx4RkzLw.jpeg)



](https://jonathan-hui.medium.com/?source=post_page---post_author_info--35c25e04c199---------------------------------------)

[

## Written by Jonathan Hui

](https://jonathan-hui.medium.com/?source=post_page---post_author_info--35c25e04c199---------------------------------------)

[41K followers](https://jonathan-hui.medium.com/followers?source=post_page---post_author_info--35c25e04c199---------------------------------------)

·[39 following](https://jonathan-hui.medium.com/following?source=post_page---post_author_info--35c25e04c199---------------------------------------)

Deep Learning

Follow

## Responses (11)

[](https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--35c25e04c199---------------------------------------)

![Dfsj](https://miro.medium.com/v2/resize:fill:32:32/0*PLjgQ4YC02_2Jtni)

Dfsj

What are your thoughts?﻿

Cancel

Respond

[

![Sowmya R Krishnan](https://miro.medium.com/v2/resize:fill:32:32/1*Q3AtC61e8K7BIWdgGkMWVw.png)





](https://medium.com/@sowmyakrishnan_15992?source=post_page---post_responses--35c25e04c199----0-----------------------------------)

[

Sowmya R Krishnan



](https://medium.com/@sowmyakrishnan_15992?source=post_page---post_responses--35c25e04c199----0-----------------------------------)

[

Jun 15, 2020

](https://medium.com/@sowmyakrishnan_15992/thank-you-for-your-excellent-article-372c6fce8443?source=post_page---post_responses--35c25e04c199----0-----------------------------------)

Thank you for your excellent article!

I have a question in the Policy Gradient section. I was under the impression that the rewards are usually calculated only through a critic. But when you introduce the actor-critic method, I understood that it is…more

1 reply

Reply

[

![Priyank Sharma](https://miro.medium.com/v2/resize:fill:32:32/0*AblLd18s6kOqsNat.)





](https://medium.com/@priyanksharma?source=post_page---post_responses--35c25e04c199----1-----------------------------------)

[

Priyank Sharma



](https://medium.com/@priyanksharma?source=post_page---post_responses--35c25e04c199----1-----------------------------------)

[

Jun 19, 2019

](https://medium.com/@priyanksharma/nice-article-f6e3fa5b3aa1?source=post_page---post_responses--35c25e04c199----1-----------------------------------)

Nice Article..

Reply

[

![Changan Chen](https://miro.medium.com/v2/resize:fill:32:32/0*qioPILLbV7PUlV_z)





](https://medium.com/@changanvr?source=post_page---post_responses--35c25e04c199----2-----------------------------------)

[

Changan Chen



](https://medium.com/@changanvr?source=post_page---post_responses--35c25e04c199----2-----------------------------------)

[

May 8, 2019

](https://medium.com/@changanvr/requires-understanding-real-world-dynamics-c15802cce7fd?source=post_page---post_responses--35c25e04c199----2-----------------------------------)

==Determining actions based on observations can be much easier than understanding a model.==

requires understanding real-world dynamics

Reply

See all responses

## More from Jonathan Hui

![mAP (mean Average Precision) for Object Detection](https://miro.medium.com/v2/resize:fit:679/1*FrmKLxCtkokDC3Yr1wc70w.png)

[

![Jonathan Hui](https://miro.medium.com/v2/resize:fill:20:20/1*c3Z3aOPBooxEX4tx4RkzLw.jpeg)



](https://jonathan-hui.medium.com/?source=post_page---author_recirc--35c25e04c199----0---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

[

Jonathan Hui

](https://jonathan-hui.medium.com/?source=post_page---author_recirc--35c25e04c199----0---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

[

## mAP (mean Average Precision) for Object Detection

### AP (Average precision) is a popular metric in measuring the accuracy of object detectors like Faster R-CNN, SSD, etc. Average precision…



](https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173?source=post_page---author_recirc--35c25e04c199----0---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

Mar 7, 2018

[

7.6K

54





](https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173?source=post_page---author_recirc--35c25e04c199----0---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

![Machine Learning — Singular Value Decomposition (SVD) & Principal Component Analysis (PCA)](https://miro.medium.com/v2/resize:fit:679/0*Kik_29u0aNSWCsux)

[

![Jonathan Hui](https://miro.medium.com/v2/resize:fill:20:20/1*c3Z3aOPBooxEX4tx4RkzLw.jpeg)



](https://jonathan-hui.medium.com/?source=post_page---author_recirc--35c25e04c199----1---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

[

Jonathan Hui

](https://jonathan-hui.medium.com/?source=post_page---author_recirc--35c25e04c199----1---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

[

## Machine Learning — Singular Value Decomposition (SVD) & Principal Component Analysis (PCA)

### In machine learning (ML), one of the most important linear algebra concepts is the singular value decomposition (SVD). With all the raw…



](https://jonathan-hui.medium.com/machine-learning-singular-value-decomposition-svd-principal-component-analysis-pca-1d45e885e491?source=post_page---author_recirc--35c25e04c199----1---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

Mar 7, 2019

[

4K

35





](https://jonathan-hui.medium.com/machine-learning-singular-value-decomposition-svd-principal-component-analysis-pca-1d45e885e491?source=post_page---author_recirc--35c25e04c199----1---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

![Understanding Feature Pyramid Networks for object detection (FPN)](https://miro.medium.com/v2/resize:fit:679/0*RCxiFYR3z6NTsi2p.)

[

![Jonathan Hui](https://miro.medium.com/v2/resize:fill:20:20/1*c3Z3aOPBooxEX4tx4RkzLw.jpeg)



](https://jonathan-hui.medium.com/?source=post_page---author_recirc--35c25e04c199----2---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

[

Jonathan Hui

](https://jonathan-hui.medium.com/?source=post_page---author_recirc--35c25e04c199----2---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

[

## Understanding Feature Pyramid Networks for object detection (FPN)

### Detecting objects in different scales is challenging in particular for small objects. We can use a pyramid of the same image at different…



](https://jonathan-hui.medium.com/understanding-feature-pyramid-networks-for-object-detection-fpn-45b227b9106c?source=post_page---author_recirc--35c25e04c199----2---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

Mar 27, 2018

[

4.2K

30





](https://jonathan-hui.medium.com/understanding-feature-pyramid-networks-for-object-detection-fpn-45b227b9106c?source=post_page---author_recirc--35c25e04c199----2---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

![SSD object detection: Single Shot MultiBox Detector for real-time processing](https://miro.medium.com/v2/resize:fit:679/1*N-ZCvRQL9iwnlYTX5XM2Iw.jpeg)

[

![Jonathan Hui](https://miro.medium.com/v2/resize:fill:20:20/1*c3Z3aOPBooxEX4tx4RkzLw.jpeg)



](https://jonathan-hui.medium.com/?source=post_page---author_recirc--35c25e04c199----3---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

[

Jonathan Hui

](https://jonathan-hui.medium.com/?source=post_page---author_recirc--35c25e04c199----3---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

[

## SSD object detection: Single Shot MultiBox Detector for real-time processing

### SSD is designed for object detection in real-time. Faster R-CNN uses a region proposal network to create boundary boxes and utilizes those…



](https://jonathan-hui.medium.com/ssd-object-detection-single-shot-multibox-detector-for-real-time-processing-9bd8deac0e06?source=post_page---author_recirc--35c25e04c199----3---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

Mar 14, 2018

[

3.4K

37





](https://jonathan-hui.medium.com/ssd-object-detection-single-shot-multibox-detector-for-real-time-processing-9bd8deac0e06?source=post_page---author_recirc--35c25e04c199----3---------------------ffbfcefd_7236_4470_8659_9d77bed3be30--------------)

[

See all from Jonathan Hui

](https://jonathan-hui.medium.com/?source=post_page---author_recirc--35c25e04c199---------------------------------------)

## Recommended from Medium

![OpenAI Gym and Gymnasium: Reinforcement Learning Environments for Python](https://miro.medium.com/v2/resize:fit:679/0*zf05Z-2A_5rXq-VP.png)

[

![Neural pAi](https://miro.medium.com/v2/resize:fill:20:20/1*WMzhCjQjIT1OxUdTZs9TPQ.png)



](https://neuralpai.medium.com/?source=post_page---read_next_recirc--35c25e04c199----0---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

[

Neural pAi

](https://neuralpai.medium.com/?source=post_page---read_next_recirc--35c25e04c199----0---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

[

## OpenAI Gym and Gymnasium: Reinforcement Learning Environments for Python



](https://neuralpai.medium.com/openai-gym-and-gymnasium-reinforcement-learning-environments-for-python-c889aed0e784?source=post_page---read_next_recirc--35c25e04c199----0---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

Mar 3

[

53





](https://neuralpai.medium.com/openai-gym-and-gymnasium-reinforcement-learning-environments-for-python-c889aed0e784?source=post_page---read_next_recirc--35c25e04c199----0---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

![Value-Based vs Policy-Based Reinforcement Learning](https://miro.medium.com/v2/resize:fit:679/1*PkeEQpSJ-kViy7KmbwzSTA.png)

[

![Papers in 100 Lines of Code](https://miro.medium.com/v2/resize:fill:20:20/1*HFmaIJiZ7BehRryMgLDvxQ.jpeg)



](https://papers-100-lines.medium.com/?source=post_page---read_next_recirc--35c25e04c199----1---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

[

Papers in 100 Lines of Code

](https://papers-100-lines.medium.com/?source=post_page---read_next_recirc--35c25e04c199----1---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

[

## Value-Based vs Policy-Based Reinforcement Learning

### Two primary approaches in Reinforcement Learning (RL) are value-based methods and policy-based methods. In this article, we are going to…



](https://papers-100-lines.medium.com/value-based-vs-policy-based-reinforcement-learning-92da766696fd?source=post_page---read_next_recirc--35c25e04c199----1---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

Nov 21, 2024

[

4

1





](https://papers-100-lines.medium.com/value-based-vs-policy-based-reinforcement-learning-92da766696fd?source=post_page---read_next_recirc--35c25e04c199----1---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

![This new IDE from Google is an absolute game changer](https://miro.medium.com/v2/resize:fit:679/1*f-1HQQng85tbA7kwgECqoQ.png)

[

![Coding Beauty](https://miro.medium.com/v2/resize:fill:20:20/1*ViyWUoh4zqx294no1eENxw.png)



](https://medium.com/coding-beauty?source=post_page---read_next_recirc--35c25e04c199----0---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

In

[

Coding Beauty

](https://medium.com/coding-beauty?source=post_page---read_next_recirc--35c25e04c199----0---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

by

[

Tari Ibaba

](https://medium.com/@tariibaba?source=post_page---read_next_recirc--35c25e04c199----0---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

[

## This new IDE from Google is an absolute game changer

### This new IDE from Google is seriously revolutionary.



](https://medium.com/@tariibaba/new-google-project-idx-fae1fdd079c7?source=post_page---read_next_recirc--35c25e04c199----0---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

Mar 12

[

5.4K

315





](https://medium.com/@tariibaba/new-google-project-idx-fae1fdd079c7?source=post_page---read_next_recirc--35c25e04c199----0---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

![The Complete Guide to Building Your First AI Agent with LangGraph. (It’s Easier Than You Think)](https://miro.medium.com/v2/resize:fit:679/1*n99sL7WiNuLWxINeULGDcw.png)

[

![Data Science Collective](https://miro.medium.com/v2/resize:fill:20:20/1*0nV0Q-FBHj94Kggq00pG2Q.jpeg)



](https://medium.com/data-science-collective?source=post_page---read_next_recirc--35c25e04c199----1---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

In

[

Data Science Collective

](https://medium.com/data-science-collective?source=post_page---read_next_recirc--35c25e04c199----1---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

by

[

Paolo Perrone

](https://medium.com/@paoloperrone?source=post_page---read_next_recirc--35c25e04c199----1---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

[

## The Complete Guide to Building Your First AI Agent with LangGraph. (It’s Easier Than You Think)

### Three months into building my first commercial AI agent, everything collapsed during the client demo.



](https://medium.com/@paoloperrone/the-complete-guide-to-building-your-first-ai-agent-its-easier-than-you-think-c87f376c84b2?source=post_page---read_next_recirc--35c25e04c199----1---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

Mar 12

[

3.3K

67





](https://medium.com/@paoloperrone/the-complete-guide-to-building-your-first-ai-agent-its-easier-than-you-think-c87f376c84b2?source=post_page---read_next_recirc--35c25e04c199----1---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

![A Brief History of LLMs](https://miro.medium.com/v2/resize:fit:679/1*4bg3WZRcZMYFfler0StxXQ.png)

[

![LM Po](https://miro.medium.com/v2/resize:fill:20:20/1*8biNIOdTZO6v4MDdtPmm2Q.png)



](https://medium.com/@lmpo?source=post_page---read_next_recirc--35c25e04c199----2---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

[

LM Po

](https://medium.com/@lmpo?source=post_page---read_next_recirc--35c25e04c199----2---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

[

## A Brief History of LLMs

### From Transformers (2017) to DeepSeek-R1 (2025)



](https://medium.com/@lmpo/a-brief-history-of-lmms-from-transformers-2017-to-deepseek-r1-2025-dae75dd3f59a?source=post_page---read_next_recirc--35c25e04c199----2---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

Feb 12

[

70

2





](https://medium.com/@lmpo/a-brief-history-of-lmms-from-transformers-2017-to-deepseek-r1-2025-dae75dd3f59a?source=post_page---read_next_recirc--35c25e04c199----2---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

![Mastering Reinforcement Learning: Chapter By Chapter Guide to Sutton & Barto](https://miro.medium.com/v2/resize:fit:679/1*yuVzMhCJyDENbyhwAsrkwA.png)

[

![Ajay Kumar](https://miro.medium.com/v2/resize:fill:20:20/0*YftkGL-ygoKiogyl)



](https://medium.com/@trivajay259?source=post_page---read_next_recirc--35c25e04c199----3---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

[

Ajay Kumar

](https://medium.com/@trivajay259?source=post_page---read_next_recirc--35c25e04c199----3---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

[

## Mastering Reinforcement Learning: Chapter By Chapter Guide to Sutton & Barto

### Chapter 1: Introduction



](https://medium.com/@trivajay259/mastering-reinforcement-learning-chapter-by-chapter-guide-to-sutton-barto-f60ccc84ed89?source=post_page---read_next_recirc--35c25e04c199----3---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

Apr 19

[](https://medium.com/@trivajay259/mastering-reinforcement-learning-chapter-by-chapter-guide-to-sutton-barto-f60ccc84ed89?source=post_page---read_next_recirc--35c25e04c199----3---------------------2998ce6e_da44_4807_bf5a_517c4c84df09--------------)

[

See more recommendations

](https://medium.com/?source=post_page---read_next_recirc--35c25e04c199---------------------------------------)

[

Help

](https://help.medium.com/hc/en-us?source=post_page-----35c25e04c199---------------------------------------)

[

Status

](https://medium.statuspage.io/?source=post_page-----35c25e04c199---------------------------------------)

[

About

](https://medium.com/about?autoplay=1&source=post_page-----35c25e04c199---------------------------------------)

[

Careers

](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----35c25e04c199---------------------------------------)

[

Press

](mailto:pressinquiries@medium.com)

[

Blog

](https://blog.medium.com/?source=post_page-----35c25e04c199---------------------------------------)

[

Privacy

](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----35c25e04c199---------------------------------------)

[

Rules

](https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page-----35c25e04c199---------------------------------------)

[

Terms

](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----35c25e04c199---------------------------------------)

[

Text to speech

](https://speechify.com/medium?source=post_page-----35c25e04c199---------------------------------------)